

Def MiniWindow(Content) {
  Margins(6, Fill Rgb 13 9 1 255)
  Margins(15, Content)
  Position(TOP_STRETCHED, Texture(HORI_BAR_MINI))
  Position(BOTTOM_STRETCHED, Texture(HORI_BAR_MINI, FLIP_Y))
  Position(RIGHT_STRETCHED, Texture(VERT_BAR_MINI, FLIP_X))
  Position(LEFT_STRETCHED, Texture(VERT_BAR_MINI))
  Position(TOP_LEFT, Texture(CORNER_MINI))
  Position(TOP_RIGHT, Texture(CORNER_MINI))
  Position(BOTTOM_RIGHT, Texture(CORNER_MINI))
  Position(BOTTOM_LEFT, Texture(CORNER_MINI))
}
End

Def MiniWindow2(Content) {
  Margins(6, Fill Rgb 15 11 9 255)
  Margins(15, Content)
  Position(TOP_STRETCHED, Texture(HORI_BAR_MINI2, FLIP_Y))
  Position(BOTTOM_STRETCHED, Texture(HORI_BAR_MINI2))
  Position(RIGHT_STRETCHED, Texture(VERT_BAR_MINI2))
  Position(LEFT_STRETCHED, Texture(VERT_BAR_MINI2, FLIP_X))
  Position(TOP_LEFT, Texture(CORNER_MINI2))
  Position(TOP_RIGHT, Texture(CORNER_MINI2, FLIP_X))
  Position(BOTTOM_RIGHT, Texture(CORNER_MINI2, FLIP_XY))
  Position(BOTTOM_LEFT, Texture(CORNER_MINI2, FLIP_Y))
}
End

Def Margins(Width, Content) MarginsImpl(Width, Content) End

Def MarginTop(X, Content) Vertical { Height X {} Stretch Content } End
Def MarginBottom(X, Content) Vertical { Stretch Content Height X {} } End
Def MarginLeft(X, Content) Horizontal { Width X {} Stretch Content } End
Def MarginRight(X, Content) Horizontal { Stretch Content Width X{}  } End

Def Margins(Left, Top, Right, Bottom, Content)
  MarginLeft(Left, MarginTop(Top, MarginRight(Right, MarginBottom(Bottom, Content))))
End

Def ButtonLayout(BOTTOM1, SIDE, CORNER) {
  Texture(BUTTON_BG)
  Position(BOTTOM_STRETCHED, Texture(BOTTOM1))
  Position(TOP_STRETCHED, Texture(BOTTOM1, FLIP_Y))
  Position(RIGHT_STRETCHED, Texture(SIDE, FLIP_X))
  Position(LEFT_STRETCHED, Texture(SIDE))
  Position(BOTTOM_RIGHT, Texture(CORNER, FLIP_X))
  Position(BOTTOM_LEFT, Texture(CORNER))
  Position(TOP_RIGHT, Texture(CORNER, FLIP_XY))
  Position(TOP_LEFT, Texture(CORNER, FLIP_Y))
}
End

Def StandardButton(Content, Button) {
  ButtonLayout(BUTTON_BOTTOM, BUTTON_SIDE, BUTTON_CORNER)
  MouseOver ButtonLayout(BUTTON_BOTTOM_HIGHLIGHT, BUTTON_SIDE_HIGHLIGHT, BUTTON_CORNER_HIGHLIGHT)
  Position(MIDDLE, Margins(10, 5, 10, 8, Content))
  Button
}
End

Def LoadButtonSpacing() Height 10 {} End

Def SavedGameContent() Vertical {
  MiniWindow2({
    Horizontal {
      Vertical {
        Using "label" Text()
        Using "date" Text(14, ColorId GRAY)
        MarginTop(0, Using "viewIds" List(HORIZONTAL, ViewId(1)))
      }
      Stretch {}
      Vertical {
        Using "load" { StandardButton(Label("Load game"), { Button(CALLBACK) Button(EXIT)})}
        Using "warlord" { StandardButton(Label("Play as a warlord"), { Button(CALLBACK) Button(EXIT)})}
        Using "erase" { StandardButton(Label("Erase file"), { Button(CALLBACK) Button(EXIT)})}
      }
    }
  })
  LoadButtonSpacing()
}
End

Def Scrolling(Content)
  Scrollable(
      Vertical {
        Position(MIDDLE, {
          Texture(SCROLL_UP)
          ScrollButton(-1)
        })
        Stretch {
          Texture(SCROLLBAR)
          Scroller Position(MIDDLE, Texture(SCROLL_BUTTON))
        }
        Position(MIDDLE, {
          ScrollButton(1)
          Texture(SCROLL_DOWN)
        })
      },
      Content)
End

"load_menu" {
  Width 600
  Vertical {
    Height 400
      Using "games" Scrolling(List(VERTICAL, SavedGameContent()))
    Stretch {}
    Position(MIDDLE, Horizontal {
      Width 150 StandardButton(Height 20 Label("Start new game"), Using "new" Button(CALLBACK) Button(EXIT))
      Width 150 StandardButton(Height 20 Label("Go back"), Button(EXIT))
    })
  }
}

"unlock_message" MiniWindow({
  Button(EXIT, true)
  Margins(6, Using "view_id" NoScissor ViewId(2))
  Vertical {
    Position(MIDDLE, MarginLeft(80, MarginRight(80, Using "message" Text())))
    Height 15 {}
    Position(MIDDLE, StandardButton(Height 20 Label("Dismiss"), Button(EXIT)))
  }
})
